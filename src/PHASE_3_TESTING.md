# ğŸ§ª PHASE 3 TESTING CHECKLIST

## âœ… Quick Verification (5 minutes)

### **Test 1: Basic Auto-Generation**
```
1. Open application
2. Click "+ Create New Project" (top-left dropdown)
3. Fill in:
   - Name: "Quick Test"
   - Study Number: "TEST-001"
4. Select Study Design: "ğŸ² RCT"
5. Click "Create Project"

Expected:
âœ… Modal closes
âœ… Project created
âœ… No errors in console
```

### **Test 2: Verify Persona Created**
```
1. Navigate to "Persona Library" tab
2. Look for auto-generated persona

Expected:
âœ… See "Dr. Emma Chen, PhD" in the list
âœ… Tagged as "Biostatistician"
âœ… Focus shows "Bias Reduction"
```

### **Test 3: Verify Protocol Created**
```
1. Navigate to "Protocol Builder" tab
2. Look for auto-generated protocol

Expected:
âœ… See protocol named "Quick Test"
âœ… Study Number: "TEST-001"
âœ… Version 1.0
âœ… Status: Draft
âœ… Multiple schema blocks visible
```

---

## ğŸ“‹ Comprehensive Testing (15 minutes)

### **A. Test All 5 Study Types**

#### **1. RCT**
```
Study Design: ğŸ² Randomized Controlled Trial (RCT)
Expected Persona: Dr. Emma Chen, PhD (Biostatistician)
Expected Focus: Bias Reduction
Expected Sections: ~10 (includes "Randomization", "Blinding", "Sample Size")
Expected Statistical Plan: Mentions "ITT analysis", "Power calculation"

âœ… Test Status: _______
```

#### **2. Case Series**
```
Study Design: ğŸ“‹ Retrospective Case Series
Expected Persona: Dr. Sophia Nakamura, MD, MPH (Data Scientist)
Expected Focus: Descriptive Depth
Expected Sections: ~7 (includes "Case Selection", "Clinical Presentation")
Expected Statistical Plan: Mentions "Descriptive statistics", "No hypothesis testing"

âœ… Test Status: _______
```

#### **3. Cohort**
```
Study Design: ğŸ“Š Prospective Cohort Study
Expected Persona: Dr. Marcus Rodriguez, DrPH (Epidemiologist)
Expected Focus: Temporal Analysis
Expected Sections: ~7 (includes "Follow-Up Schedule", "Exposure Assessment")
Expected Statistical Plan: Mentions "Incidence rates", "Hazard ratios"

âœ… Test Status: _______
```

#### **4. Laboratory**
```
Study Design: ğŸ”¬ Laboratory Investigation
Expected Persona: Dr. James Park, PhD (Data Scientist)
Expected Focus: Measurement Precision
Expected Sections: ~6 (includes "Quality Control", "Measurement Protocol")
Expected Statistical Plan: Mentions "ANOVA", "Coefficient of variation"

âœ… Test Status: _______
```

#### **5. Technical Note**
```
Study Design: ğŸ“ Technical Note / Case Report
Expected Persona: Dr. Aisha Patel, MD (Biostatistician)
Expected Focus: Narrative Synthesis
Expected Sections: ~6 (includes "Case Presentation", "Literature Review")
Expected Statistical Plan: Mentions "Narrative synthesis", "No formal statistical analysis"

âœ… Test Status: _______
```

---

### **B. Test Project Isolation**

```
1. Create Project A:
   - Name: "Project Alpha"
   - Study Design: RCT
   
2. Check Persona Library:
   Expected: 1 persona (Dr. Emma Chen)

3. Create Project B:
   - Name: "Project Beta"
   - Study Design: Cohort
   
4. Check Persona Library (while in Project Beta):
   Expected: 1 persona (Dr. Marcus Rodriguez)
   
5. Switch back to Project Alpha (top-left dropdown)

6. Check Persona Library:
   Expected: 1 persona (Dr. Emma Chen) - SAME as step 2

âœ… Test Status: _______
```

---

### **C. Test localStorage Storage**

```
1. Create a project with RCT study design
2. Open browser DevTools â†’ Application â†’ Local Storage
3. Find key: PERSONAS_{projectId}
4. Inspect value

Expected JSON structure:
[
  {
    "id": "persona-project-...",
    "name": "Dr. Emma Chen, PhD",
    "role": "Biostatistician",
    "permissions": ["view", "analyze", "export"],
    "preferences": {
      "studyDesignType": "rct",
      "focus": "bias-reduction",
      "autoGenerated": true,
      "projectId": "project-...",
      ...
    }
  }
]

âœ… Test Status: _______
```

---

### **D. Test Protocol Structure**

```
1. Create RCT project
2. Navigate to Protocol Builder
3. Open the auto-generated protocol
4. Check sections list

Expected schema blocks:
âœ… At least 10 sections
âœ… Sections include:
   - "Study Design & Randomization"
   - "Inclusion/Exclusion Criteria"
   - "Primary Endpoint"
   - "Statistical Analysis Plan"
âœ… Some blocks marked as "endpoint" type
âœ… Some blocks marked as "variable" type
âœ… All blocks have metadata.aiGenerated = true

âœ… Test Status: _______
```

---

### **E. Test Statistical Plan Generation**

```
For each study type, check that the statistical plan is appropriate:

RCT:
âœ… Mentions "Intention-to-treat (ITT) analysis"
âœ… Mentions "Sample size" and participant count
âœ… Mentions "Î± = 0.05"
âœ… Lists statistical methods (Chi-square, t-test, Kaplan-Meier)

Cohort:
âœ… Mentions "Time-to-event analysis"
âœ… Mentions "Incidence rates"
âœ… Mentions "Cox proportional hazards"
âœ… Mentions "Propensity score matching"

Case Series:
âœ… Mentions "Descriptive statistics"
âœ… Mentions "Frequencies and percentages"
âœ… Explicitly states "No formal hypothesis testing"

Laboratory:
âœ… Mentions "ANOVA"
âœ… Mentions "Coefficient of variation (CV)"
âœ… Mentions "Validation" and regulatory guidelines

Technical Note:
âœ… Mentions "Narrative case report"
âœ… Mentions "Literature comparison"
âœ… Explicitly states "No formal statistical analysis"

âœ… Test Status: _______
```

---

### **F. Test Persona Settings**

```
1. Create RCT project
2. Navigate to Persona Library
3. Click on auto-generated persona
4. Inspect preferences

Expected persona configuration:
âœ… studyDesignType: "rct"
âœ… focus: "bias-reduction"
âœ… autoGenerated: true
âœ… projectId: (matches current project)
âœ… keyResponsibilities: Array with 5+ items
âœ… recommendedAnalyses: Array with 5+ items

âœ… interpretationSettings exists with:
   âœ… focus: "bias-reduction"
   âœ… conservativeLanguage: true
   âœ… requireCitation: true
   âœ… allowedInferences: Array (includes "benchmark-comparison")
   âœ… disallowedInferences: Array (includes "efficacy-claims")

âœ… languageControls exists with:
   âœ… tone: "socratic"
   âœ… confidenceLevel: 2
   âœ… neverWriteFullSections: true
   âœ… forbiddenAnthropomorphism: true
   âœ… jargonLevel: "peer-review"

âœ… citationPolicy exists with:
   âœ… strictnessLevel: "strict"
   âœ… requireSourceForClaim: true
   âœ… allowHeuristic: false
   âœ… maxUncitedSentences: 0
   âœ… citationFormat: "vancouver"
   âœ… requirePeerReviewed: true

âœ… Test Status: _______
```

---

### **G. Test Study-Specific Inferences**

Check that allowed inferences match study type:

```
RCT persona allowedInferences should include:
âœ… "statistical-method-suggestions"
âœ… "protocol-deviation-highlighting"
âœ… "intention-to-treat-analysis"

Cohort persona allowedInferences should include:
âœ… "incidence-rate-calculation"
âœ… "time-to-event-analysis"
âœ… "risk-factor-identification"

Case Series persona allowedInferences should include:
âœ… "pattern-recognition"
âœ… "hypothesis-generation"
âœ… "outlier-identification"

Case Series persona disallowedInferences should include:
âœ… "causal-inference" (unique to case series & technical notes)

âœ… Test Status: _______
```

---

## ğŸ› Common Issues & Fixes

### **Issue 1: Persona not appearing in Persona Library**
**Possible causes:**
- Project isolation not working
- localStorage not saving
- Persona Library not reading from project-scoped storage

**Debug steps:**
1. Check console for errors
2. Check localStorage keys (should have PERSONAS_{projectId})
3. Verify PersonaLibrary component is using `storage.personas.getAll(currentProject.id)`

---

### **Issue 2: Protocol not appearing in Protocol Builder**
**Possible causes:**
- Protocol generation failed
- localStorage not saving
- Protocol Builder not reading from project-scoped storage

**Debug steps:**
1. Check console for errors during project creation
2. Check localStorage keys (should have PROTOCOLS_{projectId})
3. Verify ProtocolManager is using `storage.protocols.getAll(currentProject.id)`

---

### **Issue 3: Wrong persona for study type**
**Possible causes:**
- Study design type not passed correctly
- Template mapping incorrect

**Debug steps:**
1. Add console.log in createPersonaFromStudyDNA to see studyDesignType
2. Verify STATISTICIAN_TEMPLATES has entry for that study type
3. Check generateStudyDNA function returns correct template

---

### **Issue 4: Statistical plan is empty or generic**
**Possible causes:**
- generateDefaultStatisticalPlan not called
- Study type not matching case in switch statement

**Debug steps:**
1. Check protocolContent.statisticalPlan in localStorage
2. Verify studyDesignType matches keys in `plans` Record
3. Check that metadata is passed correctly

---

## âœ… **Sign-Off Checklist**

Before marking Phase 3 complete:

- [ ] All 5 study types auto-generate personas
- [ ] All 5 study types auto-generate protocols
- [ ] Personas have correct names per study type
- [ ] Personas have appropriate allowed/disallowed inferences
- [ ] Protocols have appropriate sections per study type
- [ ] Statistical plans are study-specific
- [ ] Project isolation works (no cross-contamination)
- [ ] localStorage correctly stores project-scoped data
- [ ] No console errors during project creation
- [ ] Modal closes successfully after creation
- [ ] User is returned to dashboard

---

## ğŸ“Š **Test Results Summary**

| Test Category | Status | Notes |
|--------------|--------|-------|
| Basic Auto-Generation | â˜ | |
| All 5 Study Types | â˜ | |
| Project Isolation | â˜ | |
| localStorage Storage | â˜ | |
| Protocol Structure | â˜ | |
| Statistical Plans | â˜ | |
| Persona Settings | â˜ | |
| Study-Specific Inferences | â˜ | |

**Overall Status:** â˜ PASS  â˜ FAIL

**Notes:**
_______________________________________________________________________
_______________________________________________________________________
_______________________________________________________________________

---

**Tester:** _________________  
**Date:** _________________  
**Time Spent:** _________________  
**Build Version:** Phase 3 Complete
